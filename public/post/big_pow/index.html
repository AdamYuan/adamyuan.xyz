<!DOCTYPE html>
<html lang="en"><meta charset="utf-8"><meta name="generator" content="Hugo 0.71.1" /><meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover">
<meta name="color-scheme" content="light dark">
<meta name="supported-color-schemes" content="light dark"><title>计算3的1000000次方&nbsp;&ndash;&nbsp;AdamYuan-&gt;Blog</title><link rel="stylesheet" href="/css/core.min.3fe8a923744e0b66d5312f4346f30c05a93da06d4e65dc0a31c44e27e711d48f55b00fcece6d049f934672a81631dcdf.css" integrity="sha384-P&#43;ipI3ROC2bVMS9DRvMMBak9oG1OZdwKMcROJ&#43;cR1I9VsA/Ozm0En5NGcqgWMdzf"><meta name="twitter:card" content="summary" />
<meta name="twitter:title" content="计算3的1000000次方" /><body><section id="header">
    <div class="header wrap"><span class="header left-side"><a class="site home" href="/"><span class="site name">AdamYuan->Blog</span></a></span>
        <span class="header right-side"><div class="nav wrap"><nav class="nav"><a class="nav item" href="/categories/">Categories</a><a class="nav item" href="/tags/">Tags</a></nav></div></span></div></section><section id="content"><div class="article-container"><section class="article header">
    <h1 class="article title">计算3的1000000次方</h1><p class="article date">2018-12-02</p></section><article class="article markdown-body"><p>无意间看到 <a href="https://www.bilibili.com/video/av21610235">https://www.bilibili.com/video/av21610235</a> ，闲来无事，便自己实现了一个<br>
使用了快速幂和NTT，c++11，-O3优化，0.3秒内可得解</p>
<h1 id="结果">结果</h1>
<div class="highlight"><pre class="chroma"><code class="language-sh" data-lang="sh">$ g++ big_pow.cpp -o big_pow -O3
$ <span class="nb">time</span> ./big_pow
<span class="m">1797710116675743838039851642017955175542668535689457592096701980448789887005555782</span>  
<span class="m">5013639024539872345178584608400586756310173000789807647889087112071631584530925074</span>  
20576700326354687989043195055426409953164756466539259367768040........  
<span class="m">9458386086558274361702868947585455272881631676228081179063417221095794868962238026</span>  
<span class="m">6186186896939896900778464988674017800809943312017921778637005646990599302975876577</span>  
<span class="m">7974690259456656823649987921344102043747756854291659736198742132526761094591717405</span>  
<span class="m">35758464159433897468478655220000001</span>
0.26user 0.00system 0:00.33elapsed 81%CPU <span class="o">(</span>0avgtext+0avgdata 19452maxresident<span class="o">)</span>k
0inputs+0outputs <span class="o">(</span>0major+4219minor<span class="o">)</span>pagefaults 0swaps
</code></pre></div><h1 id="代码">代码</h1>
<div class="highlight"><pre class="chroma"><code class="language-cpp" data-lang="cpp"><span class="cp">#include</span> <span class="cpf">&lt;iostream&gt;</span><span class="cp">
</span><span class="cp"></span>
<span class="k">typedef</span> <span class="kt">long</span> <span class="kt">long</span> <span class="n">i64</span><span class="p">;</span>

<span class="k">constexpr</span> <span class="n">i64</span> <span class="n">N</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="mi">19</span><span class="p">,</span> <span class="n">K</span> <span class="o">=</span> <span class="mi">19</span><span class="p">,</span> <span class="n">P</span> <span class="o">=</span> <span class="mi">998244353ll</span><span class="p">;</span>

<span class="k">class</span> <span class="nc">NTT</span> <span class="p">{</span>
	<span class="k">private</span><span class="o">:</span>
		<span class="k">static</span> <span class="kr">inline</span> <span class="n">i64</span> <span class="n">qpow</span><span class="p">(</span><span class="n">i64</span> <span class="n">a</span><span class="p">,</span> <span class="n">i64</span> <span class="n">x</span><span class="p">,</span> <span class="n">i64</span> <span class="n">m</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">i64</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">while</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="k">if</span><span class="p">(</span><span class="n">x</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">ret</span> <span class="o">=</span> <span class="p">(</span><span class="n">ret</span><span class="o">*</span><span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span><span class="p">;</span> <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="o">*</span><span class="n">a</span><span class="p">)</span> <span class="o">%</span> <span class="n">m</span><span class="p">;</span> <span class="n">x</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">}</span>
			<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">static</span> <span class="kr">inline</span> <span class="n">i64</span> <span class="nf">to_pow2</span><span class="p">(</span><span class="n">i64</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">i64</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="k">while</span><span class="p">(</span><span class="n">ret</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="n">ret</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span>
			<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="k">static</span> <span class="kr">inline</span> <span class="n">i64</span> <span class="nf">get_upper</span><span class="p">(</span><span class="n">i64</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">i64</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1</span><span class="p">,</span> <span class="n">ret</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="k">while</span><span class="p">(</span><span class="n">a</span> <span class="o">&lt;</span> <span class="n">x</span><span class="p">)</span> <span class="p">{</span> <span class="n">a</span> <span class="o">&lt;&lt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">ret</span> <span class="o">++</span><span class="p">;</span> <span class="p">};</span>
			<span class="k">return</span> <span class="n">ret</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="n">i64</span> <span class="n">m_wn</span><span class="p">[</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">m_iwn</span><span class="p">[</span><span class="n">K</span><span class="o">+</span><span class="mi">1</span><span class="p">],</span> <span class="n">m_rev</span><span class="p">[</span><span class="n">N</span><span class="p">],</span> <span class="n">m_inv</span><span class="p">,</span> <span class="n">m_n</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
		<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">transform</span><span class="p">(</span><span class="n">i64</span> <span class="o">*</span><span class="n">a</span><span class="p">,</span> <span class="k">const</span> <span class="n">i64</span> <span class="o">*</span><span class="n">wn</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span>
			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m_n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="k">if</span><span class="p">(</span><span class="n">i</span> <span class="o">&lt;</span> <span class="n">m_rev</span><span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="n">std</span><span class="o">::</span><span class="n">swap</span><span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">a</span><span class="p">[</span><span class="n">m_rev</span><span class="p">[</span><span class="n">i</span><span class="p">]]);</span>

			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">l</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">m_n</span><span class="p">;</span> <span class="n">l</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">i64</span> <span class="n">m</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">l</span><span class="o">-</span><span class="mi">1</span><span class="p">);</span>
				<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="o">*</span><span class="n">p</span> <span class="o">=</span> <span class="n">a</span><span class="p">;</span> <span class="n">p</span> <span class="o">!=</span> <span class="n">a</span> <span class="o">+</span> <span class="n">m_n</span><span class="p">;</span> <span class="n">p</span> <span class="o">+=</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">l</span><span class="p">))</span> <span class="p">{</span>
					<span class="n">i64</span> <span class="n">w</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span>
					<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span>
						<span class="n">i64</span> <span class="n">t</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">])</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span> <span class="n">p</span><span class="p">[</span><span class="n">m</span><span class="o">+</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">-</span> <span class="n">t</span> <span class="o">+</span> <span class="n">P</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span> <span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">p</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span> <span class="n">w</span> <span class="o">=</span> <span class="p">(</span><span class="n">w</span> <span class="o">*</span> <span class="n">wn</span><span class="p">[</span><span class="n">l</span><span class="p">])</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span>
					<span class="p">}</span>
				<span class="p">}</span>
			<span class="p">}</span>
		<span class="p">}</span>

	<span class="k">public</span><span class="o">:</span>
		<span class="kr">inline</span> <span class="kt">void</span> <span class="n">Init</span><span class="p">()</span> <span class="p">{</span>
			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">l</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">l</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="n">N</span><span class="p">;</span> <span class="n">l</span> <span class="o">++</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">m_wn</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">qpow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="p">(</span><span class="n">P</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">l</span><span class="p">),</span> <span class="n">P</span><span class="p">);</span>
				<span class="n">m_iwn</span><span class="p">[</span><span class="n">l</span><span class="p">]</span> <span class="o">=</span> <span class="n">qpow</span><span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="n">P</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">P</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">l</span><span class="p">),</span> <span class="n">P</span><span class="p">);</span>
			<span class="p">}</span>
			<span class="n">m_rev</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> 
		<span class="p">}</span>
		<span class="kr">inline</span> <span class="n">i64</span> <span class="nf">SetN</span><span class="p">(</span><span class="n">i64</span> <span class="n">n</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">n</span> <span class="o">=</span> <span class="n">to_pow2</span><span class="p">(</span><span class="n">n</span><span class="p">);</span> <span class="k">if</span><span class="p">(</span><span class="n">n</span> <span class="o">==</span> <span class="n">m_n</span><span class="p">)</span> <span class="k">return</span> <span class="n">m_n</span><span class="p">;</span>
			<span class="n">m_n</span> <span class="o">=</span> <span class="n">n</span><span class="p">;</span>

			<span class="kt">int</span> <span class="n">k</span> <span class="o">=</span> <span class="n">get_upper</span><span class="p">(</span><span class="n">n</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m_n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">m_rev</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">m_rev</span><span class="p">[</span><span class="n">i</span><span class="o">&gt;&gt;</span><span class="mi">1</span><span class="p">]</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">|</span> <span class="p">(</span> <span class="p">(</span><span class="n">i</span><span class="o">&amp;</span><span class="mi">1</span><span class="p">)</span> <span class="o">&lt;&lt;</span> <span class="p">(</span><span class="n">k</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="p">);</span>
			<span class="n">m_inv</span> <span class="o">=</span> <span class="n">qpow</span><span class="p">(</span><span class="n">m_n</span><span class="p">,</span> <span class="n">P</span> <span class="o">-</span> <span class="mi">2</span><span class="p">,</span> <span class="n">P</span><span class="p">);</span>
			<span class="k">return</span> <span class="n">m_n</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">Dft</span><span class="p">(</span><span class="n">i64</span> <span class="o">*</span><span class="n">a</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="n">transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m_wn</span><span class="p">);</span> <span class="p">}</span>
		<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">Idft</span><span class="p">(</span><span class="n">i64</span> <span class="o">*</span><span class="n">a</span><span class="p">)</span> <span class="k">const</span> <span class="p">{</span> <span class="n">transform</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">m_iwn</span><span class="p">);</span> <span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">m_n</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">a</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*</span> <span class="n">m_inv</span><span class="p">)</span> <span class="o">%</span> <span class="n">P</span><span class="p">;</span> <span class="p">}</span>
<span class="p">}</span> <span class="n">ntt</span><span class="p">;</span>

<span class="n">i64</span> <span class="n">buffer</span><span class="p">[</span><span class="n">N</span><span class="p">];</span>

<span class="k">class</span> <span class="nc">BigNum</span> <span class="p">{</span>
	<span class="k">private</span><span class="o">:</span>
		<span class="n">i64</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">N</span><span class="p">]</span> <span class="o">=</span> <span class="p">{},</span> <span class="n">m_up</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
	<span class="k">public</span><span class="o">:</span>
		<span class="kr">inline</span> <span class="kt">void</span> <span class="n">Set</span><span class="p">(</span><span class="n">i64</span> <span class="n">val</span><span class="p">)</span>
		<span class="p">{</span>
			<span class="n">m_up</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span>
			<span class="k">while</span><span class="p">(</span><span class="n">val</span><span class="p">)</span> <span class="p">{</span>
				<span class="n">m_digits</span><span class="p">[</span><span class="n">m_up</span><span class="o">++</span><span class="p">]</span> <span class="o">=</span> <span class="n">val</span> <span class="o">%</span> <span class="mi">10</span><span class="p">;</span>
				<span class="n">val</span> <span class="o">/=</span> <span class="mi">10</span><span class="p">;</span>
			<span class="p">}</span>
			<span class="n">std</span><span class="o">::</span><span class="n">fill</span><span class="p">(</span><span class="n">m_digits</span> <span class="o">+</span> <span class="n">m_up</span><span class="p">,</span> <span class="n">m_digits</span> <span class="o">+</span> <span class="n">N</span><span class="p">,</span> <span class="mi">0</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">Mul</span><span class="p">(</span><span class="k">const</span> <span class="n">BigNum</span> <span class="o">&amp;</span><span class="n">bn</span><span class="p">)</span> <span class="p">{</span>
			<span class="n">std</span><span class="o">::</span><span class="n">copy</span><span class="p">(</span><span class="n">bn</span><span class="p">.</span><span class="n">m_digits</span><span class="p">,</span> <span class="n">bn</span><span class="p">.</span><span class="n">m_digits</span> <span class="o">+</span> <span class="n">N</span><span class="p">,</span> <span class="n">buffer</span><span class="p">);</span>
			<span class="n">i64</span> <span class="n">kn</span> <span class="o">=</span> <span class="n">ntt</span><span class="p">.</span><span class="n">SetN</span><span class="p">(</span><span class="n">m_up</span> <span class="o">+</span> <span class="n">bn</span><span class="p">.</span><span class="n">m_up</span><span class="p">);</span>
			<span class="n">ntt</span><span class="p">.</span><span class="n">Dft</span><span class="p">(</span><span class="n">m_digits</span><span class="p">);</span> <span class="n">ntt</span><span class="p">.</span><span class="n">Dft</span><span class="p">(</span><span class="n">buffer</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">kn</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">buffer</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="n">ntt</span><span class="p">.</span><span class="n">Idft</span><span class="p">(</span><span class="n">m_digits</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">kn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span><span class="p">;</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span>
			<span class="k">for</span><span class="p">(</span><span class="n">m_up</span> <span class="o">=</span> <span class="n">kn</span><span class="p">;</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">m_up</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">m_up</span><span class="p">);</span>
		<span class="p">}</span>
		<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">Pow</span><span class="p">()</span> <span class="p">{</span>
			<span class="n">i64</span> <span class="n">kn</span> <span class="o">=</span> <span class="n">ntt</span><span class="p">.</span><span class="n">SetN</span><span class="p">(</span><span class="n">m_up</span> <span class="o">*</span> <span class="mi">2</span><span class="p">);</span>
			<span class="n">ntt</span><span class="p">.</span><span class="n">Dft</span><span class="p">(</span><span class="n">m_digits</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">kn</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">*=</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span><span class="p">];</span>
			<span class="n">ntt</span><span class="p">.</span><span class="n">Idft</span><span class="p">(</span><span class="n">m_digits</span><span class="p">);</span>
			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">kn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="o">++</span><span class="n">i</span><span class="p">)</span> <span class="p">{</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+=</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">/</span> <span class="mi">10</span><span class="p">;</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">%=</span> <span class="mi">10</span><span class="p">;</span> <span class="p">}</span>
			<span class="k">for</span><span class="p">(</span><span class="n">m_up</span> <span class="o">=</span> <span class="n">kn</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">m_digits</span><span class="p">[</span><span class="n">m_up</span><span class="p">]</span> <span class="o">==</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">m_up</span><span class="p">);</span>
			<span class="n">m_up</span> <span class="o">++</span><span class="p">;</span>
		<span class="p">}</span>
		<span class="kr">inline</span> <span class="kt">void</span> <span class="nf">Print</span><span class="p">()</span> <span class="k">const</span> <span class="p">{</span>
			<span class="k">for</span><span class="p">(</span><span class="n">i64</span> <span class="n">i</span> <span class="o">=</span> <span class="n">m_up</span> <span class="o">-</span> <span class="mi">1</span><span class="p">;</span> <span class="n">i</span> <span class="o">&gt;=</span> <span class="mi">0</span><span class="p">;</span> <span class="o">--</span><span class="n">i</span><span class="p">)</span>
				<span class="n">putchar</span><span class="p">(</span><span class="n">m_digits</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">+</span> <span class="sc">&#39;0&#39;</span><span class="p">);</span>
			<span class="n">putchar</span><span class="p">(</span><span class="sc">&#39;\n&#39;</span><span class="p">);</span>
		<span class="p">}</span>
<span class="p">}</span> <span class="n">base</span><span class="p">,</span> <span class="n">ans</span><span class="p">;</span>

<span class="kt">int</span> <span class="nf">main</span><span class="p">()</span> <span class="p">{</span>
	<span class="n">ntt</span><span class="p">.</span><span class="n">Init</span><span class="p">();</span>
	<span class="n">base</span><span class="p">.</span><span class="n">Set</span><span class="p">(</span><span class="mi">3</span><span class="p">);</span> <span class="n">ans</span><span class="p">.</span><span class="n">Set</span><span class="p">(</span><span class="mi">1</span><span class="p">);</span>
	<span class="n">i64</span> <span class="n">a</span> <span class="o">=</span> <span class="mi">1000000</span><span class="p">;</span>
	<span class="k">while</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="p">{</span>
		<span class="k">if</span><span class="p">(</span><span class="n">a</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="n">ans</span><span class="p">.</span><span class="n">Mul</span><span class="p">(</span><span class="n">base</span><span class="p">);</span>
		<span class="n">a</span> <span class="o">&gt;&gt;=</span> <span class="mi">1</span><span class="p">;</span> <span class="n">base</span><span class="p">.</span><span class="n">Pow</span><span class="p">();</span>
	<span class="p">}</span>
	<span class="n">ans</span><span class="p">.</span><span class="n">Print</span><span class="p">();</span>
	<span class="k">return</span> <span class="mi">0</span><span class="p">;</span>
<span class="p">}</span>
</code></pre></div></article><section class="article labels"><a class="category" href=/categories/%E6%97%A5%E5%B8%B8/>日常</a><a class="tag" href=/tags/ntt/>NTT</a></section><section class="article author"><img class="avatar" src="/img/avatar.png" alt><p class="name">AdamYuan</p><div class="details"><a class="item" href="https://github.com/AdamYuan" target="_blank"><span class="iconfont icon-github"></span>&nbsp;AdamYuan</a><a class="item" href="mailto:y13916619121@126.com" target="_blank"><span class="iconfont icon-email"></span>&nbsp;y13916619121@126.com</a></div>
</section></div>
<div class="article bottom"><section class="article navigation"><p><a class="link" href="/post/sasat_implementation/"><span class="iconfont icon-article"></span>模拟退火求解3-SAT的C++程序实现</a></p><p><a class="link" href="/post/2b-pin-heng-shu/"><span class="iconfont icon-article"></span>二逼平衡树(splay / vector + 线段树)</a></p></section></div></section><section id="footer"><div class="footer-wrap">
    <p class="copyright">©2019 AdamYuan.</p>
    <p class="powerby"><span>Powered by </span><a href="https://gohugo.io" 
        target="_blank">Hugo</a><span> and the </span><a href="https://themes.gohugo.io/hugo-notepadium/" 
        target="_blank">Notepadium</a></p>
</div></section><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.css" integrity="sha384-zB1R0rpPzHqg7Kpt0Aljp8JPLqbXI3bhnPWROx27a9N0Ll6ZP/&#43;DiW/UqRcLbRjq" crossorigin="anonymous"><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/katex.min.js" integrity="sha384-y23I5Q6l&#43;B6vatafAwxRu/0oK/79VlbSz7Q9aiSZUvyWYIYsd&#43;qj&#43;o24G5ZU2zJz" crossorigin="anonymous"></script><script defer src="https://cdn.jsdelivr.net/npm/katex@0.11.1/dist/contrib/auto-render.min.js" integrity="sha384-kWPLUVMOks5AQFrykwIup5lo0m3iMkkHrD0uJ4H5cjeGihAutqP0yW0J6dpFiVkI" crossorigin="anonymous"
            onload="renderMathInElement(document.body);"></script></body>

</html>